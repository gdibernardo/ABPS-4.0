\documentclass[12pt,a4paper,openright,twoside]{book}
\usepackage[italian]{babel}
\usepackage[latin1]{inputenc}
\usepackage{fancyhdr}
\usepackage{indentfirst}
\usepackage{graphicx}
\graphicspath{ {Images/}  }
\usepackage{newlfont}
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{latexsym}
\usepackage{amsthm}
\usepackage{listings}
\usepackage{xcolor}
\usepackage{mdframed}
\usepackage{epigraph}
\usepackage{csquotes}

\usepackage{lipsum}

\usepackage{pgfplots}

\pgfplotsset{
  compat=newest,
  xlabel near ticks,
  ylabel near ticks
}


\definecolor{gabrielecodegreen}{rgb}{0.25,0.43,0.45}
\definecolor{gabrielecodegray}{rgb}{0.5,0.5,0.5}
\definecolor{gabrielecodemagenta}{rgb}{0.65,0.09,0.56}
\definecolor{gabrielebackcolor}{rgb}{1,1,1}
\definecolor{gabrieleredcolor}{rgb}{0.7,0,0.075}


\definecolor{codegreen}{rgb}{0,0.6,0}
\definecolor{codegray}{rgb}{0.5,0.5,0.5}
\definecolor{codepurple}{rgb}{0.58,0,0.82}
\definecolor{backcolour}{rgb}{0.95,0.95,0.92}

\lstdefinestyle{gabrielecodestyle}
{
    language=C,
    backgroundcolor=\color{gabrielebackcolor},   
    commentstyle=\color{gabrielecodegreen},
    keywordstyle=\color{gabrielecodemagenta},
    numberstyle=\tiny\color{codegray},
    stringstyle=\color{gabrieleredcolor},
    basicstyle= \fontsize{11}{11}\selectfont\ttfamily,
    breakatwhitespace=false,         
    breaklines=true,                 
    captionpos=b,                    
    keepspaces=true,                 
    numbers=left,                    
    numbersep=5pt,                  
    showspaces=false,                
    showstringspaces=false,
    showtabs=false,                  
    tabsize=2,
    xleftmargin=.25in,
    xrightmargin=.25in
}






\lstdefinestyle{mystyle}
{
    language=C,
    backgroundcolor=\color{backcolour},   
    commentstyle=\color{codegreen},
    keywordstyle=\color{magenta},
    numberstyle=\tiny\color{codegray},
    stringstyle=\color{codepurple},
    basicstyle=\footnotesize,
    breakatwhitespace=false,         
    breaklines=true,                 
    captionpos=b,                    
    keepspaces=true,                 
    numbers=left,                    
    numbersep=5pt,                  
    showspaces=false,                
    showstringspaces=false,
    showtabs=false,                  
    tabsize=2
}
 
 \lstset{style=gabrielecodestyle}
     


\colorlet{punct}{red!60!black}
\definecolor{background}{HTML}{EEEEEE}
\definecolor{delim}{RGB}{20,105,176}
\colorlet{numb}{magenta!60!black}

\lstdefinelanguage{json}{
    basicstyle=\normalfont\ttfamily,
    numbers=left,
    numberstyle=\scriptsize,
    stepnumber=1,
    numbersep=8pt,
    showstringspaces=false,
    breaklines=true,
    frame=lines,
    backgroundcolor=\color{background},
    literate=
     *{0}{{{\color{numb}0}}}{1}
      {1}{{{\color{numb}1}}}{1}
      {2}{{{\color{numb}2}}}{1}
      {3}{{{\color{numb}3}}}{1}
      {4}{{{\color{numb}4}}}{1}
      {5}{{{\color{numb}5}}}{1}
      {6}{{{\color{numb}6}}}{1}
      {7}{{{\color{numb}7}}}{1}
      {8}{{{\color{numb}8}}}{1}
      {9}{{{\color{numb}9}}}{1}
      {:}{{{\color{punct}{:}}}}{1}
      {,}{{{\color{punct}{,}}}}{1}
      {\{}{{{\color{delim}{\{}}}}{1}
      {\}}{{{\color{delim}{\}}}}}{1}
      {[}{{{\color{delim}{[}}}}{1}
      {]}{{{\color{delim}{]}}}}{1},
}
 
 
 
\pagestyle{fancy}\addtolength{\headwidth}{20pt}
\renewcommand{\chaptermark}[1]{\markboth{\thechapter.\ #1}{}}
\renewcommand{\sectionmark}[1]{\markright{\thesection \ #1}{}}
\rhead[\fancyplain{}{\bfseries\leftmark}]{\fancyplain{}{\bfseries\thepage}}
\cfoot{}
\linespread{1.3}  
\begin{document}

\begin{titlepage}               

\thispagestyle{empty}                  
\topmargin=6.5cm                        
\raggedleft                            	
\large                                 		
\em                                    
%Questa \`e la \textsc{Dedica}:\\
%ognuno pu\`o scrivere quello che vuole, \\
%anche nulla \ldots     
\newpage                            
\clearpage{\pagestyle{empty}\cleardoublepage}
\end{titlepage}
\pagenumbering{roman}                   
\chapter*{Abstract}             

\rhead[\fancyplain{}{\bfseries
Abstract}]{\fancyplain{}{\bfseries\thepage}}
\lhead[\fancyplain{}{\bfseries\thepage}]{\fancyplain{}{\bfseries
Abstract}}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%aggiunge la voce Introduzione
                                        %   nell'indice
\addcontentsline{toc}{chapter}{Abstract}
\input{Introduction}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%non numera l'ultima pagina sinistra
\clearpage{\pagestyle{empty}\cleardoublepage}
\tableofcontents                        %crea l'indice
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%imposta l'intestazione di pagina
\rhead[\fancyplain{}{\bfseries\leftmark}]{\fancyplain{}{\bfseries\thepage}}
\lhead[\fancyplain{}{\bfseries\thepage}]{\fancyplain{}{\bfseries
ABSTRACT}}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%non numera l'ultima pagina sinistra
\clearpage{\pagestyle{empty}\cleardoublepage}
\listoffigures                          %crea l'elenco delle figure
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%non numera l'ultima pagina sinistra
\clearpage{\pagestyle{empty}\cleardoublepage}
\listoftables                           %crea l'elenco delle tabelle
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%non numera l'ultima pagina sinistra
\clearpage{\pagestyle{empty}\cleardoublepage}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%imposta l'intestazione di pagina


\lhead[\fancyplain{}{\bfseries\thepage}]{\fancyplain{}{\bfseries\rightmark}}

\pagenumbering{arabic}                  %mette i numeri arabi


\include{NetworkIntroduction}
\clearpage{\pagestyle{empty}\cleardoublepage}
\include{KernelLinux}
\clearpage{\pagestyle{empty}\cleardoublepage}
\include{Architettura}
\clearpage{\pagestyle{empty}\cleardoublepage}
\include{TED}
\clearpage{\pagestyle{empty}\cleardoublepage}
%!TEX encoding = UTF-8 Unicode\pagestyle{empty}
\clearpage{\pagestyle{empty}\cleardoublepage}
\include{APIs}
\clearpage{\pagestyle{empty}\cleardoublepage}
\include{Test}
\clearpage{\pagestyle{empty}\cleardoublepage}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%non numera l'ultima pagina sinistra
\clearpage{\pagestyle{empty}\cleardoublepage}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%per fare le conclusioni
\chapter*{Conclusioni e sviluppi futuri}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%imposta l'intestazione di pagina
\rhead[\fancyplain{}{\bfseries
CONCLUSIONI}]{\fancyplain{}{\bfseries\thepage}}
\lhead[\fancyplain{}{\bfseries\thepage}]{\fancyplain{}{\bfseries
CONCLUSIONI}}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%aggiunge la voce Conclusioni
                                        %   nell'indice
\addcontentsline{toc}{chapter}{Conclusioni e sviluppi futuri} 
\input{ConclusionAndFutureWorks}


 %\cite{K3,K4}.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%imposta l'intestazione di pagina
\renewcommand{\chaptermark}[1]{\markright{\thechapter \ #1}{}}
\lhead[\fancyplain{}{\bfseries\thepage}]{\fancyplain{}{\bfseries\rightmark}}
\appendix                               %imposta le appendici
\chapter{Prima Appendice}               %crea l'appendice
In questa Appendice non si \`e utilizzato il comando:\\
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\verb"" è equivalente all'
                                        %   ambiente verbatim,
                                        %   ma si utilizza all'interno
                                        %   di un discorso.
\verb"\clearpage{\pagestyle{empty}\cleardoublepage}", ed infatti
l'ultima pagina 8 ha l'intestazione con il numero di pagina in
alto.
 METTERE COS'È E COME È FATTO UN SOCKET??
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%imposta l'intestazione di pagina
\rhead[\fancyplain{}{\bfseries \thechapter \:Prima Appendice}]
{\fancyplain{}{\bfseries\thepage}}
\chapter{Seconda Appendice}             %crea l'appendice
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%imposta l'intestazione di pagina
\begin{section}{Customizzazione kernel Linux}
Può esserci l'esigenza di personalizzare il proprio kernel per adattarlo alle proprie esigenze. Alcuni vantaggi che si possono ottenere dalla customizzazione del kernel sono:
\begin{itemize}
 \item Velocizzare l'avvio del sistema.
 \item Sfruttare un'ottimizzazione basata sul proprio processore per avere un sistema operativo un po' più reattivo.
 \item Ottenere una configurazione leggermente diversa e più adatta alla propria macchina.
 \item Cercare di migliorare le prestazioni del proprio dispositivo.
 \item Ridurre i consumi.
 \item Installare solo i moduli necessari.
 \item Rendere il sistema più leggero.
\end{itemize}
Per personalizzare il kernel, però, serve una buona conoscenza della propria macchina, ed in particolare del proprio hardware.
Se non ci conosce il proprio hardware, infatti, si rischia di peggiorare le prestazione e si rischia di togliere dei moduli che possono influire sul funzionamento del sistema.

Non è necessario compilare un kernel nei casi in cui l'hardware non funzioni alla perfezione o le periferiche non vengano completamente riconosciute.
A volte per far riconoscere correttamente al sistema una data periferica basta caricare i moduli necessari con le dovute opzioni.
È utile ricompilare il kernel solo se tali moduli non sono presenti o se si è certi che i driver della periferica sono presenti solo in una versione diversa da quella attualmente in uso.
Inoltre, l'aumento di prestazioni tende a essere irrilevante, soprattutto su computer già veloci. 
È anche bene tenere presente che compilare un nuovo kernel significa, nella sostanza, cambiare sistema operativo, in quanto esso ne costituisce il motore; inoltre è richiesta un buona conoscenza del proprio hardware. 
%http://wiki.ubuntu-it.org/AmministrazioneSistema/CompilazioneKernel
% BIBLIOGRAFIA
\\
Dopo aver analizzato i vantaggi e gli svantaggi della personalizzazione del kernel, spieghiamo ora come si può fare la customizzazione.
Per modificare il kernel bisogna determinare quali driver sono necessari, compilare i kernel ed i moduli ed infine installare l'immagine del kernel.
\\
I passi da eseguire per portare a termine una customizzazione sono:
\begin{paragraph}{Scaricare una versione stabile del kernel ed estrarlo}
\begin{mdframed}[backgroundcolor=gray!30, topline=false,rightline=false,  leftline=false, bottomline=false ]
 \texttt{\# cd /directory/}
 \\
 \texttt{\# wget https://www.kernel.org/pub/linux/kernel/
 \\	v4.x/linux-4.0.1.tar.xz}
 \\
 \texttt{\# tar -xvJf linux-4.0.1.tar.xz}
 
\end{mdframed}
Il link indicato è quello relativo alla pagina ufficiale, dove si possono trovare le ultime versioni dei kernel. La versione scelta da noi è stata la 4.0.1 in quanto era l'ultima stabile.
\end{paragraph}
\begin{paragraph}{Scegliere la configurazione}
\begin{mdframed}[backgroundcolor=gray!30, topline=false,rightline=false,  leftline=false, bottomline=false ]
 
 \texttt{\# cd linux-4.0.1}
 \\
 \texttt{\# sudo apt-get install libncurses5}
 \\
 \texttt{\# sudo apt-get install libncurses5-dev}
 \\
 \\
 \texttt{\# sudo make menuconfig}
 
\end{mdframed}
Per poter eseguire il comando di menuconfig è necessario installare prima i componenti \emph{libncurses5}.
Una volta eseguito il comando di configurazione, si aprirà una finestra come quella indicata in figura ~\ref{fig:KernelLinuxMenuconfig}
Nel caso in cui si volessero aggiungere o rimuovere moduli, bisognerà andare a selezionarli all'interno di questo menu.

\begin{figure}[h]
    \centering
    \includegraphics[width=1\textwidth]{KernelLinuxMenuconfig}
    \caption{Esecuzione del comando menuconfig.}
     \label{fig:KernelLinuxMenuconfig}
\end{figure}
\end{paragraph}

\begin{paragraph}{Compilare il Kernel}
\begin{mdframed}[backgroundcolor=gray!30, topline=false,rightline=false,  leftline=false, bottomline=false ]
 \texttt{\# sudo make } 
\end{mdframed}
Con questo comando si va a compilare il kernel. Questa operazione può richiedere diverso tempo, in particolare in dispositivi con prestazione ridotte.
È possibile anche specificare l'opzione -jN con N che indica il numero di core più uno ( ad esempio \emph{-j5} per un quad-core ) per velocizzare l'operazione.

\end{paragraph}

\begin{paragraph}{Compilare i moduli ed installarli}
\begin{mdframed}[backgroundcolor=gray!30, topline=false,rightline=false,  leftline=false, bottomline=false ]
 \texttt{\# sudo make modules} 
 \\
 \texttt{\# sudo make modules\_install} 
\end{mdframed}

\end{paragraph}


\begin{paragraph}{Installare il Kernel}
\begin{mdframed}[backgroundcolor=gray!30, topline=false,rightline=false,  leftline=false, bottomline=false ]
 \texttt{\# sudo make install} 
 \\
 \texttt{\# sudo reboot} 
 
\end{mdframed}
Come ultima operazione si va ad installare l'immagine del nuovo kernel.
Una volta riavviato il sistema è possibile utilizzare il proprio kernel customizzato.

\end{paragraph}




\end{section}

\rhead[\fancyplain{}{\bfseries \thechapter \:Seconda Appendice}]
{\fancyplain{}{\bfseries\thepage}}

\include{Bibliography}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%non numera l'ultima pagina sinistra
\clearpage{\pagestyle{empty}\cleardoublepage}
\chapter*{Ringraziamenti}
\thispagestyle{empty}
\end{document}